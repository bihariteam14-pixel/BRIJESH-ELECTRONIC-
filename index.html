<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
    <title>Brijesh Electronic & Social</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    
    <style>
        /* --- GENERAL --- */
        body { font-family: 'Segoe UI', sans-serif; margin: 0; background: #f0f2f5; padding-bottom: 70px; user-select: none; }
        
        /* HEADER */
        .site-header { background: #1a237e; color: white; padding: 12px 15px; display: flex; justify-content: space-between; align-items: center; position: sticky; top: 0; z-index: 1000; box-shadow: 0 2px 5px rgba(0,0,0,0.2); }
        .header-logo { height: 40px; border-radius: 5px; background: white; padding: 2px; }
        .header-icons i { font-size: 1.3em; margin-left: 15px; cursor: pointer; }

        /* MENU */
        .dropdown-menu { display: none; position: absolute; top: 50px; right: 10px; background: white; width: 220px; box-shadow: 0 5px 15px rgba(0,0,0,0.2); border-radius: 5px; z-index: 2000; }
        .dropdown-menu.show { display: block; }
        .dropdown-menu a { display: block; padding: 12px; border-bottom: 1px solid #eee; text-decoration: none; color: #333; font-weight: bold; cursor: pointer; }

        /* SECTIONS */
        .page-section { display: none; padding: 10px; }
        .page-section.active { display: block; }

        /* --- SHOP UI --- */
        .shop-grid { display: grid; gap: 20px; }
        .shop-card { background: white; border-radius: 10px; overflow: hidden; box-shadow: 0 4px 15px rgba(0,0,0,0.1); }
        .shop-card img { width: 100%; height: 220px; object-fit: cover; border-bottom: 2px solid #eee; }
        .shop-details { padding: 15px; }
        .shop-details h2 { color: #007bff; font-size: 1.5em; margin: 0 0 10px 0; }
        .problem-list { list-style: none; padding: 0; margin: 10px 0; text-align: left; }
        .problem-list li { padding: 5px 0; border-bottom: 1px dashed #eee; font-size: 0.95em; color: #555; display: flex; }
        .problem-list li:before { content: 'üëâ'; margin-right: 8px; }
        .shop-btn { width: 100%; background: #28a745; color: white; padding: 12px; border: none; border-radius: 5px; font-weight: bold; margin-top: 10px; font-size: 1em; cursor: pointer; }

        /* --- SOCIAL UI --- */
        .stories-wrapper { display: flex; gap: 10px; overflow-x: auto; padding: 10px; background: white; margin-bottom: 10px; border-radius: 8px; }
        .story-item { min-width: 80px; height: 140px; border-radius: 10px; position: relative; overflow: hidden; background: #000; border: 2px solid #1a237e; flex-shrink: 0; }
        .story-item img { width: 100%; height: 100%; object-fit: cover; }
        .story-item p { position: absolute; bottom: 5px; width: 100%; text-align: center; color: white; font-size: 10px; font-weight: bold; margin: 0; text-shadow: 1px 1px 2px black; }
        .story-add { background: white; border: 2px dashed #ccc; display: flex; align-items: center; justify-content: center; flex-direction: column; }
        
        .create-post { background: white; padding: 15px; display: flex; gap: 10px; align-items: center; border-radius: 8px; margin-bottom: 15px; }
        .user-dp { width: 40px; height: 40px; border-radius: 50%; object-fit: cover; border: 1px solid #ddd; }
        .post-card { background: white; margin-bottom: 15px; border-radius: 8px; padding-bottom: 5px; }
        .post-header { padding: 10px; display: flex; align-items: center; gap: 10px; }
        .post-media { width: 100%; max-height: 400px; object-fit: contain; background: black; }

        /* --- MODALS --- */
        .modal { display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.8); z-index: 5000; justify-content: center; align-items: center; }
        .modal-content { background: white; padding: 20px; width: 95%; max-width: 400px; border-radius: 10px; position: relative; max-height: 90vh; overflow-y: auto; }
        .close-btn { position: absolute; top: 10px; right: 15px; font-size: 24px; cursor: pointer; z-index: 10; }
        .full-btn { width: 100%; padding: 12px; border: none; border-radius: 5px; font-weight: bold; margin-top: 10px; color: white; cursor: pointer;}
        .inp { width: 100%; padding: 10px; margin: 10px 0; border: 1px solid #ccc; border-radius: 5px; box-sizing: border-box; }

        /* BOTTOM NAV */
        .bottom-nav { position: fixed; bottom: 0; width: 100%; background: white; border-top: 1px solid #ddd; display: flex; justify-content: space-around; padding: 12px 0; z-index: 4000; }
        .nav-icon { font-size: 22px; color: #666; cursor: pointer; }
        .nav-icon.active { color: #1a237e; }

        #storyViewer { display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: black; z-index: 6000; flex-direction: column; }
        .track-card { background: #e3f2fd; padding: 15px; border-radius: 8px; border-left: 5px solid #1a237e; margin-top: 10px; text-align: left;}
    </style>
</head>
<body>

    <audio id="orderSound">
      <source src="https://assets.mixkit.co/sfx/preview/mixkit-bell-notification-933.mp3">
    </audio>

    <div class="site-header">
        <div style="display: flex; align-items: center; gap: 10px;">
            <img src="https://i.ibb.co/XfXkYvR/1000027264.jpg" class="header-logo" alt="Brijesh Logo">
            <h2 id="appTitle" style="margin:0; font-size: 1.1rem; letter-spacing: 1px;">Brijesh Electronic</h2>
        </div>
        <div class="header-icons"><i class="fas fa-bars" onclick="toggleMenu()"></i></div>
    </div>

    <div id="shopView" class="page-section active">
        <div class="shop-grid">
            
            <div class="shop-card">
                <img src="https://images.unsplash.com/photo-1593359677879-a4bb92f829d1?q=80&w=800" alt="LED TV Repair">
                <div class="shop-details">
                    <h2>üì∫ TV Repair Service</h2>
                    <ul class="problem-list">
                        <li>Screen Panel Repair</li>
                        <li>No Power / Dead TV</li>
                        <li>Sound OK, No Picture</li>
                        <li>Backlight Replacement</li>
                        <li>Software & Motherboard</li>
                    </ul>
                    <button class="shop-btn" onclick="openOrder('TV Repair')">Order Now</button>
                </div>
            </div>

            <div class="shop-card">
                <img src="https://images.unsplash.com/photo-1545173168-9f1947eebb7f?q=80&w=800" alt="Washing Machine Repair">
                <div class="shop-details">
                    <h2>üß∫ Washing Machine Repair</h2>
                    <ul class="problem-list">
                        <li>Spin / Dryer Not Working</li>
                        <li>PCB Repair & Change</li>
                        <li>Water Leakage Issue</li>
                        <li>Unusual Noise Repair</li>
                        <li>Motor Replacement</li>
                    </ul>
                    <button class="shop-btn" onclick="openOrder('Washing Machine')">Order Now</button>
                </div>
            </div>

            <div class="shop-card">
                <img src="https://images.unsplash.com/photo-1621259182978-fbf93132d53d?q=80&w=800" alt="DTH Dish Repair">
                <div class="shop-details">
                    <h2>üì° Dish/DTH Service</h2>
                    <ul class="problem-list">
                        <li>Signal Alignment (Set Karein)</li>
                        <li>New Dish Installation</li>
                        <li>LNB & Wire Replacement</li>
                        <li>No Signal Problem Fix</li>
                        <li>Location Shift Service</li>
                    </ul>
                    <button class="shop-btn" onclick="openOrder('Dish Antenna')">Order Now</button>
                </div>
            </div>

            <div class="shop-card">
                <img src="https://images.unsplash.com/photo-1558346490-a72e53ae2d4f?q=80&w=800" alt="Cable & Wire Repair">
                <div class="shop-details">
                    <h2>üîå Cable Fixing</h2>
                    <ul class="problem-list">
                        <li>Internal Wiring Fix</li>
                        <li>New Cable Connection</li>
                        <li>Port & Connector Repair</li>
                        <li>Audio/Video Cable Issue</li>
                        <li>Smart Box Setup</li>
                    </ul>
                    <button class="shop-btn" onclick="openOrder('Cable Fixing')">Order Now</button>
                </div>
            </div>

        </div>
    </div>

    <div id="socialView" class="page-section">
        <div class="stories-wrapper" id="storyTray">
            <div class="story-item story-add" onclick="openModal('storyUploadModal')">
                <i class="fas fa-plus-circle" style="font-size:30px; color:#1a237e;"></i>
                <p style="color:#333;">Add Story</p>
            </div>
        </div>
        <div class="create-post" onclick="openModal('postModal')">
            <img src="https://via.placeholder.com/50" class="user-dp global-pic">
            <div style="flex:1; background:#f0f2f5; padding:10px; border-radius:20px; color:#666;">What's on your mind?</div>
        </div>
        <div id="feedContainer"></div>
    </div>

    <div id="trackView" class="page-section" style="text-align:center;">
        <h2>üì¶ Track Your Order</h2>
        <input type="text" id="trackIdInp" class="inp" placeholder="Enter Order ID">
        <button class="full-btn" style="background:#1a237e;" onclick="trackMyOrder()">Track Status</button>
        <div id="trackResult"></div>
    </div>

    <div id="adminView" class="page-section">
        <div style="display:flex; justify-content:space-between; align-items:center;">
            <h2>üîë Admin Orders</h2>
            <i class="fas fa-times-circle" style="color:red; font-size:30px; cursor:pointer;" onclick="switchTab('shop')"></i>
        </div>
        <div id="orderList"></div>
    </div>

    <div id="profileView" class="page-section" style="text-align:center;">
        <div style="position:relative; display:inline-block; margin-top:20px;">
            <img src="https://via.placeholder.com/120" id="profileDp" class="global-pic" style="width:120px; height:120px; border-radius:50%; border:3px solid #1a237e; object-fit:cover;">
            <label for="picInp" style="position:absolute; bottom:0; right:0; background:#1a237e; color:white; padding:8px; border-radius:50%; cursor:pointer;"><i class="fas fa-camera"></i></label>
            <input type="file" id="picInp" hidden accept="image/*" onchange="changePic(this)">
        </div>
        <h2 id="profileNameDisplay">Guest</h2>
        <input type="text" id="nameInp" class="inp" placeholder="Update Name">
        <button class="full-btn" style="background:#1a237e;" onclick="saveName()">Save Changes</button>
    </div>

    <div class="bottom-nav">
        <i class="fas fa-store nav-icon active" id="navShop" onclick="switchTab('shop')"></i>
        <i class="fas fa-search-location nav-icon" id="navTrack" onclick="switchTab('track')"></i>
        <i class="fas fa-users nav-icon" id="navSocial" onclick="switchTab('social')"></i>
        <i class="fas fa-user-circle nav-icon" id="navProfile" onclick="switchTab('profile')"></i>
    </div>

    <div id="mainMenu" class="dropdown-menu">
        <a onclick="switchTab('shop')">üè† Shop Home</a>
        <a onclick="switchTab('track')">üì¶ Track Order</a>
        <a onclick="switchTab('social')">üë• Social Feed</a>
        <a onclick="switchTab('profile')">üë§ My Profile</a>
        <a onclick="checkAdmin()" id="adminMenuLink">üîë Admin Panel</a>
    </div>

    <div id="orderModal" class="modal">
        <div class="modal-content">
            <span class="close-btn" onclick="closeModal('orderModal')">&times;</span>
            <h3 id="orderTitle">Booking</h3>
            <select id="problemSelect" class="inp"></select>
            <input type="text" id="orderName" class="inp" placeholder="Your Name">
            <input type="tel" id="orderPhone" class="inp" placeholder="WhatsApp Number">
            <textarea id="orderAddr" class="inp" placeholder="Full Address"></textarea>
            <button class="full-btn" style="background:#28a745;" onclick="confirmOrder()">Confirm Booking</button>
        </div>
    </div>

    <div id="postModal" class="modal">
        <div class="modal-content">
            <span class="close-btn" onclick="closeModal('postModal')">&times;</span>
            <h3>Create Post</h3>
            <textarea id="pText" class="inp" style="height:80px;" placeholder="What's new in electronics?"></textarea>
            <input type="file" id="pFile" accept="image/*" onchange="previewPost(this)">
            <button class="full-btn" style="background:#1877F2;" onclick="publishPost()">Post Now</button>
        </div>
    </div>

    <script>
        const ADMIN_WHATSAPP = "918920017674"; 
        let userData = JSON.parse(localStorage.getItem('user_data')) || { name: "Guest", pic: "https://via.placeholder.com/150" };
        let stories = JSON.parse(localStorage.getItem('stories') || '[]');
        let posts = JSON.parse(localStorage.getItem('posts') || '[]');
        let currentSvc = "";
        let mediaBuffer;

        const probsDB = {
            'TV Repair': ['Panel Damage', 'No Power', 'Display Line', 'Backlight Problem', 'Motherboard'],
            'Washing Machine': ['Dryer Issue', 'Drum Not Rotating', 'PCB Fault', 'Water Leakage', 'Noisy Motor'],
            'Dish Antenna': ['No Signal', 'Dish Re-fitting', 'New Set-top Box', 'Wire Change', 'LNB Fault'],
            'Cable Fixing': ['Internal Wiring', 'Connector Change', 'Signal Loss', 'New Connection', 'AV Port Fix']
        };

        window.onload = () => { applyUser(); loadStories(); loadPosts(); };

        function applyUser() {
            document.querySelectorAll('.global-pic').forEach(img => img.src = userData.pic);
            document.getElementById('profileNameDisplay').innerText = userData.name;
        }

        function switchTab(id) {
            document.querySelectorAll('.page-section').forEach(p => p.classList.remove('active'));
            document.querySelectorAll('.nav-icon').forEach(n => n.classList.remove('active'));
            document.getElementById(id+'View').classList.add('active');
            document.getElementById('nav' + id.charAt(0).toUpperCase() + id.slice(1)).classList.add('active');
            document.getElementById('mainMenu').classList.remove('show');
        }

        function toggleMenu() { document.getElementById('mainMenu').classList.toggle('show'); }
        function openModal(id) { document.getElementById(id).style.display = 'flex'; }
        function closeModal(id) { document.getElementById(id).style.display = 'none'; }

        function openOrder(svc) {
            currentSvc = svc; 
            document.getElementById('orderTitle').innerText = svc;
            let sel = document.getElementById('problemSelect'); 
            sel.innerHTML = "";
            (probsDB[svc] || ['Other Issue']).forEach(p => { sel.innerHTML += `<option value="${p}">${p}</option>`; });
            openModal('orderModal');
        }

        function confirmOrder() {
            let name = document.getElementById('orderName').value;
            let phone = document.getElementById('orderPhone').value;
            let addr = document.getElementById('orderAddr').value;
            let prob = document.getElementById('problemSelect').value;
            if(!name || !phone || !addr) return alert("Please fill all details!");

            let orderId = "ORD" + Math.floor(Math.random()*10000);
            let orderObj = { id: orderId, svc: currentSvc, problem: prob, name: name, phone: phone, addr: addr, status: "Pending", date: new Date().toLocaleString() };
            
            let orders = JSON.parse(localStorage.getItem('orders') || '[]');
            orders.push(orderObj);
            localStorage.setItem('orders', JSON.stringify(orders));

            let msg = `*NEW SERVICE ORDER*%0A*ID:* ${orderId}%0A*Service:* ${orderObj.svc}%0A*Problem:* ${orderObj.problem}%0A*Customer:* ${orderObj.name}%0A*Phone:* ${orderObj.phone}%0A*Address:* ${orderObj.addr}`;
            window.location.href = `https://wa.me/${ADMIN_WHATSAPP}?text=${msg}`;
        }

        function trackMyOrder() {
            let id = document.getElementById('trackIdInp').value.trim();
            let orders = JSON.parse(localStorage.getItem('orders') || '[]');
            let o = orders.find(x => x.id === id);
            let res = document.getElementById('trackResult');
            if(o) {
                res.innerHTML = `<div class="track-card"><b>Status: <span style="color:blue">${o.status}</span></b><br>Service: ${o.svc}<br>Date: ${o.date}</div>`;
            } else { res.innerHTML = "<p style='color:red;'>Order ID not found!</p>"; }
        }

        function checkAdmin() {
            if(prompt("Admin Password:") === "1234") { loadAdmin(); switchTab('admin'); }
            else { alert("Wrong!"); }
        }

        function loadAdmin() {
            let orders = JSON.parse(localStorage.getItem('orders') || '[]');
            document.getElementById('orderList').innerHTML = orders.map((o, i) => `
                <div style="background:white; padding:10px; border-bottom:1px solid #ddd; margin-bottom:5px;">
                    <b>ID: ${o.id}</b> | ${o.svc}<br>
                    ${o.name} (${o.phone})<br>
                    Status: <b>${o.status}</b>
                </div>
            `).join('');
        }

        function previewPost(i) { 
            let r = new FileReader(); 
            r.onload = e => mediaBuffer = e.target.result;
            r.readAsDataURL(i.files[0]); 
        }

        function publishPost() {
            let txt = document.getElementById('pText').value;
            posts.unshift({ user: userData.name, pic: userData.pic, text: txt, img: mediaBuffer });
            localStorage.setItem('posts', JSON.stringify(posts));
            closeModal('postModal'); loadPosts();
        }

        function loadPosts() {
            document.getElementById('feedContainer').innerHTML = posts.map(p => `
                <div class="post-card">
                    <div class="post-header"><img src="${p.pic}" class="user-dp"><b>${p.user}</b></div>
                    <div style="padding:10px;">${p.text}</div>
                    ${p.img ? `<img src="${p.img}" class="post-media">` : ''}
                </div>
            `).join('');
        }

        function changePic(input) {
            if(input.files[0]) {
                let r = new FileReader();
                r.onload = e => { userData.pic = e.target.result; saveUser(); };
                r.readAsDataURL(input.files[0]);
            }
        }
        function saveName() {
            let n = document.getElementById('nameInp').value;
            if(n) { userData.name = n; saveUser(); alert("Profile Updated!"); }
        }
        function saveUser() { localStorage.setItem('user_data', JSON.stringify(userData)); applyUser(); }
        function loadStories() {
            let tray = document.getElementById('storyTray');
            tray.innerHTML = `<div class="story-item story-add" onclick="openModal('storyUploadModal')"><i class="fas fa-plus-circle"></i></div>` + 
            stories.map((s,i) => `<div class="story-item"><img src="${s.img}"><p>${s.user}</p></div>`).join('');
        }
    </script>
</body>
</html>
